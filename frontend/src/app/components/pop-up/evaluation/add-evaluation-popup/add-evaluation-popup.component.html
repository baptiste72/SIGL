<div class="dialog-header bg-blue">
  <h2 mat-dialog-title>Ajout d'un livrable</h2>
</div>

<form [formGroup]="addEvaluationForm" (ngSubmit)="addEvaluation()">
  <div mat-dialog-content class="dialog-content">
    <div class="div-input">
      <h3>Nom</h3>
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Planning 2022-2023</mat-label>
        <input type="text" matInput formControlName="name" />
        <mat-error
          *ngIf="submitted && addEvaluationForm.hasError('required', 'name')"
        >
          Merci de renseigner un nom
        </mat-error>
      </mat-form-field>
    </div>

    <div class="div-input">
      <h3>Promotion</h3>
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Choisissez une promotion associée</mat-label>
        <mat-select required formControlName="yearGroup">
          <mat-option
            *ngFor="let yearGroup of yearGroups"
            [value]="yearGroup.id"
          >
            {{ yearGroup.worded }}
          </mat-option>
        </mat-select>
        <mat-error
          *ngIf="
            submitted && addEvaluationForm.hasError('required', 'yearGroup')
          "
        >
          Merci de renseigner une promotion
        </mat-error>
      </mat-form-field>
    </div>

    <div class="div-input">
      <h3>Type de livrable</h3>
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Choisissez un type</mat-label>
        <mat-select required formControlName="type">
          <mat-option *ngFor="let type of type" [value]="type.value">
            {{ type.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="div-input">
      <h3>Statut</h3>
      <mat-form-field class="full-width" appearance="fill">
        <mat-label>Choisissez un statut</mat-label>
        <mat-select required formControlName="status">
          <mat-option *ngFor="let status of status" [value]="status.value">
            {{ status.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <button type="button" mat-raised-button (click)="fileInput.click()">
      Sélectionnez un fichier PDF :
    </button>
    <input
      hidden
      (change)="onFileSelected($event)"
      #fileInput
      type="file"
      accept=".pdf"
      formControlName="pdf"
    />
    <span>{{ selectedFile?.name }}</span>
    <mat-error
      *ngIf="submitted && addEvaluationForm.hasError('required', 'pdf')"
    >
      Merci de renseigner un livrable
    </mat-error>

    <mat-divider></mat-divider>
    <div mat-dialog-actions align="end">
      <button mat-button class="green bold">AJOUTER</button>
      <button mat-button class="red bold" (click)="closeDialog()">
        ANNULER
      </button>
    </div>
  </div>
</form>
